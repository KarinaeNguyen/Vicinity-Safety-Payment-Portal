<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate="title">C·ªïng Thanh To√°n QR | VICINITY SAFETY</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://www.google.com/recaptcha/enterprise.js?render=6Ldm0AssAAAAAMIE9rP6GwaCTGvgA2RYBWOBBE7aW" async defer></script>
    
    <style>
        /* Google-inspired design colors */
        .g-blue {
            background-color: #4285F4;
        }
        .g-text-blue {
            color: #4285F4;
        }
        .flag-button {
            font-size: 1.5rem;
            line-height: 1;
            padding: 0 4px;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
            border: none;
            background: none;
        }
        .flag-button:hover, .flag-button.active {
            opacity: 1;
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Roboto', 'Inter', 'sans-serif'],
                    },
                }
            }
        }
        
        // --- D·ªÆ LI·ªÜU D·ªäCH THU·∫¨T (TRANSLATION DATA) ---
        const translations = {
            en: {
                title: "QR Payment Gate | VICINITY SAFETY", company_name: "VICINITY SAFETY", secure_payment: "SECURE PAYMENT", account_no: "Account No:", copy_no: "Copy No.", payment_steps_title: "Payment Steps:",
                step_1: "Click 'Verify Security' to display the QR code.", step_2: "Scan the QR code with your mobile banking app to pay.", step_3: "Verify the recipient is VICINITY SAFETY CO., LTD.",
                check_btn: "Verify Security to View QR", checking_btn: "Verifying security...", 
                security_failed: "Security check failed. Please try refreshing the page.", 
                transfer_note: "Please remember to enter the correct amount and your Name/Phone number in the transfer description (e.g., Tuan Tran 1234567890).",
                privacy_link: "Privacy Policy & Terms of Service"
            },
            vi: {
                title: "C·ªïng Thanh To√°n QR | VICINITY SAFETY", company_name: "VICINITY SAFETY", secure_payment: "THANH TO√ÅN AN TO√ÄN", account_no: "S·ªë t√†i kho·∫£n:", copy_no: "Sao ch√©p", payment_steps_title: "C√°c b∆∞·ªõc Thanh to√°n:",
                step_1: "Nh·∫•p v√†o 'X√°c minh B·∫£o m·∫≠t' ƒë·ªÉ hi·ªÉn th·ªã m√£ QR.", step_2: "Qu√©t m√£ QR b·∫±ng ·ª©ng d·ª•ng ng√¢n h√†ng di ƒë·ªông c·ªßa b·∫°n ƒë·ªÉ thanh to√°n.", step_3: "X√°c minh ng∆∞·ªùi nh·∫≠n l√† VICINITY SAFETY CO., LTD.",
                check_btn: "X√°c minh B·∫£o m·∫≠t ƒë·ªÉ xem QR", checking_btn: "ƒêang x√°c minh b·∫£o m·∫≠t...", 
                security_failed: "Ki·ªÉm tra b·∫£o m·∫≠t th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l√†m m·ªõi trang.", 
                transfer_note: "Qu√Ω kh√°ch vui l√≤ng nh·ªõ ƒëi·ªÅn ƒë√∫ng s·ªë ti·ªÅn v√† th√¥ng tin t√™n/SƒêT trong n·ªôi dung chuy·ªÉn ti·ªÅn (VD: Tuan Tran 1234567890).",
                privacy_link: "Ch√≠nh s√°ch B·∫£o m·∫≠t & ƒêi·ªÅu kho·∫£n D·ªãch v·ª•"
            },
            zh: {
                title: "‰∫åÁª¥Á†ÅÊîØ‰ªòÈó®Êà∑ | VICINITY SAFETY", company_name: "VICINITY SAFETY", secure_payment: "ÂÆâÂÖ®ÊîØ‰ªò", account_no: "Ë¥¶Âè∑:", copy_no: "Â§çÂà∂", payment_steps_title: "‰ªòÊ¨æÊ≠•È™§:",
                step_1: "ÁÇπÂáª'È™åËØÅÂÆâÂÖ®'‰ª•ÊòæÁ§∫‰∫åÁª¥Á†Å.", step_2: "‰ΩøÁî®ÊÇ®ÁöÑÊâãÊú∫Èì∂Ë°åÂ∫îÁî®Êâ´Êèè‰∫åÁª¥Á†ÅËøõË°åÊîØ‰ªò.", step_3: "È™åËØÅÊî∂Ê¨æ‰∫∫ÊòØ VICINITY SAFETY CO., LTD.",
                check_btn: "È™åËØÅÂÆâÂÖ®‰ª•Êü•Áúã QR", checking_btn: "Ê≠£Âú®È™åËØÅÂÆâÂÖ®...", 
                security_failed: "ÂÆâÂÖ®Ê£ÄÊü•Â§±Ë¥•. ËØ∑Â∞ùËØïÂà∑Êñ∞È°µÈù¢.", 
                transfer_note: "ËØ∑Âä°ÂøÖÂú®ËΩ¨Ë¥¶ËØ¥Êòé‰∏≠Â°´ÂÜôÊ≠£Á°ÆÁöÑÈáëÈ¢ùÂíåÊÇ®ÁöÑÂßìÂêç/ÁîµËØùÂè∑Á†Å (‰æãÂ¶Ç: Tuan Tran 1234567890)„ÄÇ",
                privacy_link: "ÈöêÁßÅÊîøÁ≠ñ‰∏éÊúçÂä°Êù°Ê¨æ"
            }
        };

        let currentLang = 'vi';

        function changeLanguage(lang) {
            currentLang = lang;
            document.title = translations[lang].title;
            localStorage.setItem('paymentLang', lang); 

            document.querySelectorAll('.flag-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`flag-${lang}`).classList.add('active');

            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                const text = translations[lang][key];
                element.textContent = text;
            });
            // C·∫≠p nh·∫≠t text cho n√∫t x√°c minh b·∫£o m·∫≠t
            const checkButton = document.getElementById('check-security-btn');
            if (checkButton) {
                if (checkButton.disabled) {
                    checkButton.textContent = translations[currentLang].checking_btn;
                } else {
                    checkButton.textContent = translations[currentLang].check_btn;
                }
            }
            // C·∫≠p nh·∫≠t copy button text
            document.getElementById('copy-btn').textContent = translations[currentLang].copy_no;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const storedLang = localStorage.getItem('paymentLang') || 'vi';
            changeLanguage(storedLang);
        });
        
        function showValidationError(message) {
            const errorElement = document.getElementById('validation-error');
            errorElement.textContent = message;
            errorElement.classList.remove('hidden');
            setTimeout(() => { errorElement.classList.add('hidden'); }, 5000);
        }

        function copyText(text, elementId) {
            if (!navigator.clipboard) {
                const tempInput = document.createElement('textarea');
                tempInput.value = text;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
            } 
            else { 
                navigator.clipboard.writeText(text).catch(err => { 
                    console.error('Could not copy text: ', err); 
                }); 
            }

            const button = document.getElementById(elementId);
            const originalText = button.textContent;
            button.innerHTML = '<svg class="w-4 h-4 mr-1 inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> ƒê√£ sao ch√©p!'; 
            setTimeout(() => { button.textContent = originalText; }, 3000);
        }

        // --- CH·ª®C NƒÇNG B·∫¢O M·∫¨T M·ªöI (NEW SECURITY FUNCTIONALITY) ---
        async function runSecurityCheck() {
            const checkButton = document.getElementById('check-security-btn');
            
            checkButton.disabled = true;
            checkButton.textContent = translations[currentLang].checking_btn; 

            grecaptcha.enterprise.ready(async () => {
                try {
                    // 1. CH·∫†Y reCAPTCHA
                    const token = await grecaptcha.enterprise.execute('6Ldm0AssAAAAAMIE9rP6GwaCTGvgA2RYBWOBBE7aW', {action: 'view_qr_code'});
                    
                    // 2. N·∫æU TH√ÄNH C√îNG, HI·ªÇN TH·ªä QR V√Ä ·∫®N N√öT
                    document.getElementById('qr-security-check').classList.add('hidden');
                    document.getElementById('qr-code-display').classList.remove('hidden');

                } catch (error) {
                    // 3. N·∫æU TH·∫§T B·∫†I, HI·ªÇN TH·ªä L·ªñI V√Ä K√çCH HO·∫†T L·∫†I N√öT
                    checkButton.disabled = false;
                    checkButton.textContent = translations[currentLang].check_btn;
                    showValidationError(translations[currentLang].security_failed);
                }
            });
        }
    </script>
</head>

<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4 font-sans">

    <div class="w-full max-w-sm bg-white p-6 rounded-xl shadow-lg border border-gray-100 space-y-6">

        <div class="flex justify-end space-x-1">
            <button id="flag-en" class="flag-button" onclick="changeLanguage('en')" title="English">üá∫üá∏</button>
            <button id="flag-vi" class="flag-button active" onclick="changeLanguage('vi')" title="Ti·∫øng Vi·ªát">üáªüá≥</button>
            <button id="flag-zh" class="flag-button" onclick="changeLanguage('zh')" title="‰∏≠Êñá">üá®üá≥</button>
        </div>

        <div class="text-center space-y-1 pb-4 border-b border-gray-200">
             <div class="flex items-center justify-center text-gray-800 text-2xl">
                <span class="font-extrabold g-text-blue" data-translate="company_name">VICINITY SAFETY</span>
            </div>
            <div class="text-gray-500 text-sm">
                <span class="font-medium text-green-600 mr-2" data-translate="secure_payment">THANH TO√ÅN AN TO√ÄN</span>
                <span data-translate="account_no">S·ªë t√†i kho·∫£n:</span> 318851299
                <button id="copy-btn" onclick="copyText('318851299', 'copy-btn')" 
                        class="ml-2 text-xs text-blue-500 hover:text-blue-700 transition duration-150" data-translate="copy_no">
                    Sao ch√©p
                </button>
            </div>
        </div>

        <div id="qr-code-display" class="hidden p-4 bg-white rounded-lg shadow-inner border border-gray-200 space-y-3">
            <img src="Company Bank QR.png" 
                  alt="VietQR Payment Code for Techcombank" 
                  class="w-full h-auto rounded-md">
            
            <div class="p-3 bg-yellow-100 border border-yellow-300 rounded-lg text-sm text-gray-700">
                <p class="font-medium" data-translate="transfer_note">
                    Qu√Ω kh√°ch vui l√≤ng nh·ªõ ƒëi·ªÅn ƒë√∫ng s·ªë ti·ªÅn v√† th√¥ng tin t√™n/SƒêT trong n·ªôi dung chuy·ªÉn ti·ªÅn (VD: Tuan Tran 1234567890).
                </p>
            </div>
        </div>
        
        <div id="qr-security-check" class="space-y-4">
            <div id="validation-error" class="hidden bg-red-100 border-l-4 border-red-500 text-red-700 p-3 text-sm rounded-md" role="alert"></div>

            <p class="text-sm text-gray-500 text-center">
                M√£ QR ƒë∆∞·ª£c b·∫£o v·ªá b·∫±ng Google reCAPTCHA. Vui l√≤ng x√°c minh ƒë·ªÉ xem.
            </p>

            <button type="button" id="check-security-btn" onclick="runSecurityCheck()"
                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-md text-sm font-medium text-white g-blue hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150" 
                data-translate="check_btn">
                X√°c minh B·∫£o m·∫≠t ƒë·ªÉ xem QR
            </button>
        </div>

        <div class="text-sm text-gray-700 space-y-2 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-400">
            <p class="font-semibold text-gray-800" data-translate="payment_steps_title">C√°c b∆∞·ªõc Thanh to√°n:</p>
            <ol class="list-decimal list-inside space-y-1">
                <li data-translate="step_1">Nh·∫•p v√†o **'X√°c minh B·∫£o m·∫≠t'** ƒë·ªÉ hi·ªÉn th·ªã m√£ QR.</li>
                <li data-translate="step_2">Qu√©t m√£ QR b·∫±ng ·ª©ng d·ª•ng ng√¢n h√†ng di ƒë·ªông c·ªßa b·∫°n ƒë·ªÉ thanh to√°n.</li>
                <li data-translate="step_3">X√°c minh ng∆∞·ªùi nh·∫≠n l√† **VICINITY SAFETY CO., LTD**.</li>
            </ol>
        </div>

        <div class="text-center pt-2 border-t border-gray-100">
            <a href="#" class="text-xs text-gray-400 hover:text-blue-500" data-translate="privacy_link">Ch√≠nh s√°ch B·∫£o m·∫≠t & ƒêi·ªÅu kho·∫£n D·ªãch v·ª•</a>
        </div>

    </div>
</body>
</html>
